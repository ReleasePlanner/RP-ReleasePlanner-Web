# Dockerfile para desarrollo de NestJS con hot-reload
FROM node:20-alpine

# Establecer directorio de trabajo en la raíz del workspace
WORKDIR /app

# Copiar archivos de configuración de dependencias del workspace
COPY package*.json ./
COPY nx.json ./
COPY tsconfig.base.json ./

# Instalar todas las dependencias (incluyendo dev dependencies)
RUN npm ci

# Exponer puerto 3000
EXPOSE 3000

# Comando por defecto (puede ser sobrescrito en docker-compose)
# Se ejecuta desde la raíz del workspace usando nx
CMD ["npx", "nx", "serve", "api"]

